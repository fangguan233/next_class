# 智能课程表 v1.1.2

## v1.1.2 更新日志 (2025-08-14)

本次更新聚焦于**分享功能的重构和用户体验的全面优化**，旨在提供一个更安全、更便捷、更友好的课程表分享与导入流程。

### ✨ 新功能 & 优化

1.  **分享系统重构 (分享码)**
    *   **告别繁琐**：移除了原有的导出/导入JSON文件的功能。
    *   **一键分享**：现在，用户可以通过点击“分享课程表”按钮，生成一个唯一的、随机的**6位数字分享码**。
    *   **轻松导入**：其他用户只需在导入界面输入此6位分享码，即可轻松获取课程表数据。

2.  **全新的UI弹窗**
    *   为了提升交互体验，我们为分享和导入流程设计了**自定义的UI弹窗**，完全取代了浏览器原生、生硬的 `alert` 和 `prompt` 对话框，界面更加美观、统一。

3.  **用户体验 (UX) 增强**
    *   **无缝复制**：点击“复制”分享码后，会显示一个短暂、无阻塞的“Toast”提示，而不是需要手动关闭的确认框。
    *   **数据安全提示**：在通过分享码导入数据时，若检测到本地已有课程表，会弹出明确的**覆盖确认警告**，有效防止用户误操作导致数据丢失。

4.  **暗色模式 (Dark Mode) 修复**
    *   全面修复了在暗色模式下，弹窗中的按钮、输入框等UI元素颜色不正确、文字看不清的问题，确保了在所有光照环境下都有一致且舒适的视觉体验。

### 🔒 后端安全与稳定

1.  **分享速率限制 (Rate Limiting)**
    *   为了防止服务被滥用，为分享功能增加了基于IP的**速率限制**。默认配置下，同一IP地址在60秒内只能进行一次分享操作。此项可在 `.env` 文件中配置。

2.  **分享自动过期**
    *   所有通过分享码共享的课程表文件都具有**时效性**。服务器会自动清理超过24小时的分享文件，确保了数据的安全性和服务器资源的有效利用。此项同样可在 `.env` 文件中配置。

---

## 项目简介

本项目是一个智能课程表查询应用。该版本 (v1.1.2) 经过了重大的架构重构，后端服务已从原有的 Node.js 技术栈迁移至 **Python + Flask**，实现了更清晰的代码结构、更稳定的性能和更规范的服务管理。

前端通过原生 HTML, CSS, 和 JavaScript 实现，并利用 Tailwind CSS 构建现代化UI。后端利用大语言模型（通义千问）的强大能力，智能解析用户粘贴的非结构化课程表文本，并将其转换为标准化的JSON数据。

## 技术栈

- **后端**: Python 3.9+, Flask
- **前端**: HTML, CSS, JavaScript (ES6)
- **UI框架**: Tailwind CSS (via CDN)
- **AI模型**: 通义千问 (Qwen-Coder)
- **运行环境**: Conda (base)

## 核心功能

- **智能文本解析**: 粘贴任何格式的课程表文本，AI自动解析为结构化数据。
- **下一节课速览**: 在主页清晰地展示即将到来的下一节课信息。
- **完整周课表**: 以周视图的形式展示本周所有课程。
- **本地数据持久化**: 课程数据安全地存储在用户本地浏览器中。
- **天气预报**: 集成逐小时天气预报，为出行提供参考。
- **明暗模式切换**: 适应不同光线环境下的使用习惯。
- **服务化管理**: 提供标准的启停脚本，便于在Linux服务器上部署和管理。

## 部署与运行 (Linux/Conda 环境)

本项目设计为在 Conda 环境中运行。

### 1. 启动服务

执行启动脚本：
```bash
sh start_server.sh
```
该脚本会自动完成以下操作：
1.  激活 `conda base` 环境。
2.  进入 `backend` 目录。
3.  安装或更新所有必要的 Python 依赖库。
4.  在后台启动 Flask 服务器（默认运行在 **1000** 端口）。
5.  将服务的进程ID (PID) 保存到 `backend/server.pid` 文件中。

服务启动后，所有输出日志将被重定向到 `backend/nohup.out` 文件。

### 2. 停止服务

执行停止脚本：
```bash
sh stop.sh
```
该脚本会自动读取 `backend/server.pid` 文件，并终止对应的服务进程，然后删除PID文件。
